<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>RTSDK</title><meta name="description" content="Documentation for RTSDK"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"><a href="https://www.npmjs.com/package/@rtsdk/topia">NPM Package</a><a href="https://github.com/metaversecloud-com/sdk-examples">Examples</a></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">RTSDK</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<h2>RTSDK</h2></div>
<div class="tsd-panel tsd-typography">
<a href="#javascript-rtsdk---topia-client-library" id="javascript-rtsdk---topia-client-library" style="color: inherit; text-decoration: none;">
  <h1>Javascript RTSDK - Topia Client Library</h1>
</a>
<p>The Topia Client Library leverages the Topia Public API and allows users to interact with the topia systems and modify their world programmatically. With the SDK you can now build new features to be used in Topia! Questions, comments, or have something exciting to share with the Topia team? Reach out to <a href="mailto:developers@topia.io">developers@topia.io</a>!</p>

<a href="#authorization" id="authorization" style="color: inherit; text-decoration: none;">
  <h2>Authorization</h2>
</a>
<p>A Topia provided API Key can be included with every object initialization as a parameter named <code>apiKey</code>. This API Key is used to in authorization headers in all calls to the Public API. Use it wisely and sparingly! The API Key should only be used to authorize your app (and therefore all of it&#39;s users) to perform specific actions. In most case the ability to interact with an SDK application should be controlled per user using Interactive Credentials (see below).</p>

<a href="#want-to-build-interactive-assets-this-is-how-you-can-get-started" id="want-to-build-interactive-assets-this-is-how-you-can-get-started" style="color: inherit; text-decoration: none;">
  <h3>Want to build interactive assets? This is how you can get started:</h3>
</a>
<p>Getting a Key Pair:</p>
<ul>
<li>Navigate directly to your <a href="https://topia.io/t/dashboard/integrations">integrations page</a> or follow the steps below from within a world.<ul>
<li>Click on your image (or circle) at the top left of the left hand navbar.</li>
<li>Click Edit Profile. This will bring you to a separate dashboard.</li>
<li>Click Integrations on the left nav</li>
</ul>
</li>
<li>Click the “Add Key Pair” button. This is going to be your public / private key pair for your app.</li>
</ul>
<p>Adding a Key Pair to an asset:</p>
<p>Make an asset “interactive” by adding your PUBLIC key to the integrations page of the asset editor.</p>
<ul>
<li>Go back to your world. Make sure you are in “Edit Mode” by toggling on Edit on the left nav bar</li>
<li>Hover over any asset. Click the pencil icon that should show up on hover and select “Edit”</li>
<li>Go to the Integrations tab</li>
<li>At the bottom, you&#39;ll see a section that says “Add player session credentials to asset interactions”. Toggle that on. Now webhooks that fire from this asset and iframes that open from this asset will include the following values:<ul>
<li>assetId</li>
<li>interactivePublicKey</li>
<li>interactiveNonce</li>
<li>visitorId</li>
<li>urlSlug</li>
</ul>
</li>
<li>The above values are included in the query params of the iframe URL as well as payload of the webhook.</li>
<li>Once you have the above values you can pass them as credentials into the factory classes when creating class instances.</li>
</ul>
<pre><code class="language-ts"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">DroppedAsset</span><span class="hl-1">.</span><span class="hl-3">get</span><span class="hl-1">(</span><span class="hl-2">assetId</span><span class="hl-1">, </span><span class="hl-2">urlSlug</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-2">credentials:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">interactivePublicKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">interactiveNonce</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">visitorId</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>
<br />


<a href="#need-an-api-key-to-test-locally-this-is-how-you-can-create-one" id="need-an-api-key-to-test-locally-this-is-how-you-can-create-one" style="color: inherit; text-decoration: none;">
  <h3>Need an API Key to test locally? This is how you can create one:</h3>
</a>
<ul>
<li>Navigate directly to your <a href="https://topia.io/t/dashboard/integrations">integrations page</a> or follow the steps below from within a world.<ul>
<li>Click on your image (or circle) at the top left of the left hand navbar.</li>
<li>Click Edit Profile. This will bring you to a separate dashboard.</li>
<li>Click Integrations on the left nav</li>
</ul>
</li>
<li>Click Generate New API Key and copy the API Key to be used in your .env and while using <a href="https://sdk-examples.metaversecloud.com">https://sdk-examples.metaversecloud.com</a></li>
</ul>
<p>Alternatively, visitors of a <a href="https://topia.io/">topia.io</a> world interact with each other and the interactively configured assets in your world without the need for an API Key. This is all made possible through Interactive Session credentials passed to the SDK with every request, when applicable. What does this mean for you? Not much, actually! All of the magic happens behind the scenes and all you have to do is make sure that new class constructors include an options object like this: <code>options: WorldOptionalInterface = { attributes: {}, credentials: {} }</code> and all calls to <code>this.topia.axios</code> include the inherited <code>this.requestOptions</code> parameter.</p>
<p><img src="https://raw.githubusercontent.com/metaversecloud-com/mc-sdk-js/main/clients/client-topia/InteractiveApplicationDevelopment.png" alt="Interactive Application Development Diagram"></p>
<br>

<hr/>


<a href="#developers" id="developers" style="color: inherit; text-decoration: none;">
  <h1>Developers</h1>
</a>
<hr/>

<p>Need inspiration?! Check out the following applications which utilizes the SDK to create new and enhanced features inside <a href="https://topia.io/">topia.io</a>:</p>
<ul>
<li><strong>TicTacToe:</strong> A turn based multiplayer game built completely on the canvas.<ul>
<li><a href="https://github.com/metaversecloud-com/sdk-tictactoe">Github</a></li>
<li><a href="https://topia.io/tictactoe-prod">Demo</a></li>
</ul>
</li>
<li><strong>Quest:</strong> A dynamic hide and seek game where an admin can drop multiple quest items within a world for users to find.<ul>
<li><a href="https://github.com/metaversecloud-com/sdk-quest">Github</a></li>
<li><a href="https://topia.io/quest-prod">Demo</a></li>
</ul>
</li>
</ul>
<br>


<a href="#get-started" id="get-started" style="color: inherit; text-decoration: none;">
  <h2>Get Started</h2>
</a>

<a href="#boilerplates" id="boilerplates" style="color: inherit; text-decoration: none;">
  <h3>Boilerplates</h3>
</a>
<p>We have two boilerplates available to help you get started. Pick the one that best suits your needs, clone it, and let the coding begin!</p>
<ul>
<li><a href="https://github.com/metaversecloud-com/sdk-boilerplate">Javascript</a></li>
<li><a href="https://github.com/metaversecloud-com/sdk-ts-boilerplate">Typescript</a></li>
</ul>
<p>Run <code>yarn add @rtsdk/topia</code> or <code>npm install @rtsdk/topia</code></p>
<p>Create your instance of Topia and instantiate the factories you need:</p>
<pre><code class="language-js"><span class="hl-2">dotenv</span><span class="hl-1">.</span><span class="hl-3">config</span><span class="hl-1">();</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">dotenv</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&quot;dotenv&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">AssetFactory</span><span class="hl-1">, </span><span class="hl-2">Topia</span><span class="hl-1">, </span><span class="hl-2">DroppedAssetFactory</span><span class="hl-1">, </span><span class="hl-2">UserFactory</span><span class="hl-1">, </span><span class="hl-2">WorldFactory</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&quot;@rtsdk/topia&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">config</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-2">apiDomain:</span><span class="hl-1"> </span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">env</span><span class="hl-1">.</span><span class="hl-6">INSTANCE_DOMAIN</span><span class="hl-1"> || </span><span class="hl-4">&quot;https://api.topia.io/&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">interactiveKey:</span><span class="hl-1"> </span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">env</span><span class="hl-1">.</span><span class="hl-6">INTERACTIVE_KEY</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">interactiveSecret:</span><span class="hl-1"> </span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">env</span><span class="hl-1">.</span><span class="hl-6">INTERACTIVE_SECRET</span><span class="hl-1">,</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">myTopiaInstance</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-3">Topia</span><span class="hl-1">(</span><span class="hl-2">config</span><span class="hl-1">);</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">Asset</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-3">AssetFactory</span><span class="hl-1">(</span><span class="hl-2">myTopiaInstance</span><span class="hl-1">);</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">DroppedAsset</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-3">DroppedAssetFactory</span><span class="hl-1">(</span><span class="hl-2">myTopiaInstance</span><span class="hl-1">);</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">User</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-3">UserFactory</span><span class="hl-1">(</span><span class="hl-2">myTopiaInstance</span><span class="hl-1">);</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">World</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-3">WorldFactory</span><span class="hl-1">(</span><span class="hl-2">myTopiaInstance</span><span class="hl-1">);</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> { </span><span class="hl-2">Asset</span><span class="hl-1">, </span><span class="hl-2">DroppedAsset</span><span class="hl-1">, </span><span class="hl-2">myTopiaInstance</span><span class="hl-1">, </span><span class="hl-2">User</span><span class="hl-1">, </span><span class="hl-2">World</span><span class="hl-1"> };</span>
</code></pre>
<br/>

<p>Put it to use:</p>
<pre><code class="language-js"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">DroppedAsset</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&quot;./pathToAboveCode&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-3">getAssetAndDataObject</span><span class="hl-1"> = </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-2">req</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> { </span><span class="hl-6">assetId</span><span class="hl-1">, </span><span class="hl-6">interactiveNonce</span><span class="hl-1">, </span><span class="hl-6">interactivePublicKey</span><span class="hl-1">, </span><span class="hl-6">urlSlug</span><span class="hl-1">, </span><span class="hl-6">visitorId</span><span class="hl-1"> } = </span><span class="hl-2">req</span><span class="hl-1">.</span><span class="hl-2">query</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">droppedAsset</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">DroppedAsset</span><span class="hl-1">.</span><span class="hl-3">get</span><span class="hl-1">(</span><span class="hl-2">assetId</span><span class="hl-1">, </span><span class="hl-2">urlSlug</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-2">credentials:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">interactiveNonce</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">interactivePublicKey</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">visitorId</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">droppedAsset</span><span class="hl-1">.</span><span class="hl-3">fetchDroppedAssetDataObject</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">droppedAsset</span><span class="hl-1">;</span><br/><span class="hl-1">};</span>
</code></pre>

<a href="#data-objects" id="data-objects" style="color: inherit; text-decoration: none;">
  <h2>Data Objects</h2>
</a>
<p>Data Objects can be used to store information such as game state, configurations, themes, and analytics.
There are three types of Data Objects:</p>
<ul>
<li><strong>World:</strong> The World data object should be used to store information unique to your app in a given world but not necessarily specific details about an instance or an active game. This information would persist even if the app was removed from the world.<ul>
<li><strong>Example - Update two specific data points:</strong><pre><code class="language-js"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">world</span><span class="hl-1">.</span><span class="hl-3">updateDataObject</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">[</span><span class="hl-4">`keyAssets.</span><span class="hl-5">${</span><span class="hl-2">keyAssetId</span><span class="hl-5">}</span><span class="hl-4">.itemsCollectedByUser.</span><span class="hl-5">${</span><span class="hl-2">profileId</span><span class="hl-5">}</span><span class="hl-4">`</span><span class="hl-2">]:</span><span class="hl-1"> { </span><span class="hl-2">[dateKey]:</span><span class="hl-1"> { </span><span class="hl-2">count:</span><span class="hl-1"> </span><span class="hl-7">1</span><span class="hl-1"> }, </span><span class="hl-2">total:</span><span class="hl-1"> </span><span class="hl-7">1</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-2">[</span><span class="hl-4">`profileMapper.</span><span class="hl-5">${</span><span class="hl-2">profileId</span><span class="hl-5">}</span><span class="hl-4">`</span><span class="hl-2">]:</span><span class="hl-1"> </span><span class="hl-2">username</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code></pre>
</li>
<li><strong>Example - Increment a specific value within the data object by 1:</strong><pre><code class="language-js"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">world</span><span class="hl-1">.</span><span class="hl-3">incrementDataObjectValue</span><span class="hl-1">([</span><span class="hl-4">`keyAssets.</span><span class="hl-5">${</span><span class="hl-2">keyAssetId</span><span class="hl-5">}</span><span class="hl-4">.totalItemsCollected.count`</span><span class="hl-1">], </span><span class="hl-7">1</span><span class="hl-1">);</span>
</code></pre>
</li>
</ul>
</li>
<li><strong>Dropped Asset:</strong> The Dropped Asset data object should only store what is unique to the specific instance of the app in the world such as game state. If the Dropped Asset is deleted, the data object would be lost as well so be sure to only store information here the doesn&#39;t need to persist!<ul>
<li><strong>Example - Initialize data object with default data and keyAssetId:</strong><pre><code class="language-js"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">droppedAsset</span><span class="hl-1">.</span><span class="hl-3">setDataObject</span><span class="hl-1">(</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    ...</span><span class="hl-2">defaultGameData</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">keyAssetId:</span><span class="hl-1"> </span><span class="hl-2">droppedAsset</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  { </span><span class="hl-2">lock:</span><span class="hl-1"> { </span><span class="hl-2">lockId</span><span class="hl-1">, </span><span class="hl-2">releaseLock:</span><span class="hl-1"> </span><span class="hl-5">true</span><span class="hl-1"> } },</span><br/><span class="hl-1">);</span>
</code></pre>
</li>
<li><strong>Example - Update lastInteraction date and playerCount:</strong><pre><code class="language-js"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">droppedAsset</span><span class="hl-1">.</span><span class="hl-3">updateDataObject</span><span class="hl-1">({ </span><span class="hl-2">lastInteraction:</span><span class="hl-1"> </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-3">Date</span><span class="hl-1">(), </span><span class="hl-2">playerCount:</span><span class="hl-1"> </span><span class="hl-2">playerCount</span><span class="hl-1"> + </span><span class="hl-7">1</span><span class="hl-1"> });</span>
</code></pre>
</li>
</ul>
</li>
<li><strong>User:</strong> The User data object should be used to store information unique to a user that is NOT unique to a world or instance (dropped asset) of an app.<ul>
<li><strong>Example - Update totalMessagesSentCount by a user across all worlds:</strong><pre><code class="language-js"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">world</span><span class="hl-1">.</span><span class="hl-3">incrementDataObjectValue</span><span class="hl-1">([</span><span class="hl-4">`totalMessagesSentCount`</span><span class="hl-1">], </span><span class="hl-7">1</span><span class="hl-1">);</span>
</code></pre>
</li>
</ul>
</li>
</ul>

<a href="#data-object-locking" id="data-object-locking" style="color: inherit; text-decoration: none;">
  <h3>Data Object Locking</h3>
</a>
<p>All of our data object set, update, and increment methods have an optional lock argument. You can create a lock id using that parameters specific to the action you are taking plus a timestamp so that the lock will expire after a certain amount of time has passed. As an example, TicTacToe allows users to Reset the game board so that they can start a new game but we&#39;d only want the reset to happen once even if the user(s) press the button multiple times. To prevent multiple resets from happening within a 10 second window (stopping the calls from going through and preventing the race condition), we&#39;d lock the object by doing the following:</p>
<pre><code class="language-js"><span class="hl-0">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">droppedAsset</span><span class="hl-1">.</span><span class="hl-3">updateDataObject</span><span class="hl-1">(</span><br/><span class="hl-1">    { </span><span class="hl-2">isResetInProgress:</span><span class="hl-1"> </span><span class="hl-5">true</span><span class="hl-1"> },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-2">lock:</span><span class="hl-1"> { </span><span class="hl-2">lockId:</span><span class="hl-1"> </span><span class="hl-4">`</span><span class="hl-5">${</span><span class="hl-2">assetId</span><span class="hl-5">}</span><span class="hl-4">-</span><span class="hl-5">${</span><span class="hl-2">resetCount</span><span class="hl-5">}</span><span class="hl-4">-</span><span class="hl-5">${</span><span class="hl-5">new</span><span class="hl-8"> </span><span class="hl-3">Date</span><span class="hl-8">(</span><span class="hl-2">Math</span><span class="hl-8">.</span><span class="hl-3">round</span><span class="hl-8">(</span><span class="hl-5">new</span><span class="hl-8"> </span><span class="hl-3">Date</span><span class="hl-8">().</span><span class="hl-3">getTime</span><span class="hl-8">() </span><span class="hl-1">/</span><span class="hl-8"> </span><span class="hl-7">10000</span><span class="hl-8">) </span><span class="hl-1">*</span><span class="hl-8"> </span><span class="hl-7">10000</span><span class="hl-8">)</span><span class="hl-5">}</span><span class="hl-4">`</span><span class="hl-1"> },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">} </span><span class="hl-0">catch</span><span class="hl-1"> (</span><span class="hl-2">error</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-3">status</span><span class="hl-1">(</span><span class="hl-7">409</span><span class="hl-1">).</span><span class="hl-3">json</span><span class="hl-1">({ </span><span class="hl-2">message:</span><span class="hl-1"> </span><span class="hl-4">&quot;Reset already in progress.&quot;</span><span class="hl-1"> });</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Using the code above would also allow us to check if <code>isResetInProgress === true</code> and prevent the code from progress immediately. Make sure that when using a lock such as this that you also call <code>await droppedAsset.updateDataObject({ isResetInProgress: false })};</code> after all reset functionality has been executed.</p>
<p><strong>Turn based locking</strong>
Locking data object updates can also be extremely helpful when building a turn based game. As an example, TicTacToe should only allow one user to take a turn at a time. To prevent multiple moves at once we could use the following:</p>
<pre><code class="language-js"><span class="hl-0">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">timestamp</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-3">Date</span><span class="hl-1">(</span><span class="hl-2">Math</span><span class="hl-1">.</span><span class="hl-3">round</span><span class="hl-1">(</span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-3">Date</span><span class="hl-1">().</span><span class="hl-3">getTime</span><span class="hl-1">() / </span><span class="hl-7">5000</span><span class="hl-1">) * </span><span class="hl-7">5000</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">lockId</span><span class="hl-1"> = </span><span class="hl-4">`</span><span class="hl-5">${</span><span class="hl-2">keyAssetId</span><span class="hl-5">}</span><span class="hl-4">-</span><span class="hl-5">${</span><span class="hl-2">resetCount</span><span class="hl-5">}</span><span class="hl-4">-</span><span class="hl-5">${</span><span class="hl-2">turnCount</span><span class="hl-5">}</span><span class="hl-4">-</span><span class="hl-5">${</span><span class="hl-2">timestamp</span><span class="hl-5">}</span><span class="hl-4">`</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">droppedAsset</span><span class="hl-1">.</span><span class="hl-3">updateDataObject</span><span class="hl-1">({}, { </span><span class="hl-2">lock:</span><span class="hl-1"> { </span><span class="hl-2">lockId</span><span class="hl-1">, </span><span class="hl-2">releaseLock:</span><span class="hl-1"> </span><span class="hl-5">false</span><span class="hl-1"> } });</span><br/><span class="hl-1">} </span><span class="hl-0">catch</span><span class="hl-1"> (</span><span class="hl-2">error</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-3">status</span><span class="hl-1">(</span><span class="hl-7">409</span><span class="hl-1">).</span><span class="hl-3">json</span><span class="hl-1">({ </span><span class="hl-2">message:</span><span class="hl-1"> </span><span class="hl-4">&quot;Move already in progress.&quot;</span><span class="hl-1"> });</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Once complete be sure to also call <code>await keyAsset.updateDataObject({ turnCount: turnCount + 1 });</code> so that the next player is free to take their turn!</p>
<p><strong>Custom analytics</strong>
You can leverage the data object methods for all types to track analytics unique to your Public Key by passing <code>analytics</code> as an optional array to all calls that set, update, or increment data objects!</p>
<pre><code class="language-js"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">droppedAsset</span><span class="hl-1">.</span><span class="hl-3">updateDataObject</span><span class="hl-1">({ </span><span class="hl-2">isResetInProgress:</span><span class="hl-1"> </span><span class="hl-5">true</span><span class="hl-1"> }, { </span><span class="hl-2">analytics:</span><span class="hl-1"> [</span><span class="hl-4">&quot;resetCount&quot;</span><span class="hl-1">], </span><span class="hl-2">lock:</span><span class="hl-1"> { </span><span class="hl-2">lockId</span><span class="hl-1"> } });</span>
</code></pre>
<p>Note: This does NOT impact the data objects themselves but rather allows you to track custom analytics (incremented by 1) across all instances of your application with a given Public Key.</p>
<br>

<hr/>

<br>


<a href="#contributors" id="contributors" style="color: inherit; text-decoration: none;">
  <h1>Contributors</h1>
</a>
<hr/>

<br>


<a href="#get-started-1" id="get-started-1" style="color: inherit; text-decoration: none;">
  <h2>Get Started</h2>
</a>
<p>Run <code>gh repo clone metaversecloud-com/mc-sdk-js</code></p>
<br>


<a href="#issues" id="issues" style="color: inherit; text-decoration: none;">
  <h2>Issues</h2>
</a>
<p>We&#39;ve added an Issue template to help standardize Issues and ensure they have enough detail for a developer to start work and help prevent contributors from forgetting to add an important piece of information.</p>
<br>


<a href="#pull-requests" id="pull-requests" style="color: inherit; text-decoration: none;">
  <h2>Pull Requests</h2>
</a>
<p>We&#39;ve added a Pull Request template to help make it easier for developers to clarify what the proposed changes will do. This helps facilitate clear communication between all contributors of the SDK and ensures that we are all on the same page!</p>
<br>


<a href="#documentation" id="documentation" style="color: inherit; text-decoration: none;">
  <h2>Documentation</h2>
</a>
<p>We use <a href="https://typedoc.org/guides/overview">TypeDoc</a> to convert comments in TypeScript source code into rendered HTML documentation. Comments should be simple and concise and include examples where applicable. Please be sure to add or update comments accordingly!</p>
<p>To update docs run <code>yarn docs</code>.</p>
<p>To view docs locally open <code>mc-sdk-js/clients/client-topia/docs/modules.html</code> in your browser.</p>
<p>Example of Class comments:</p>
<pre><code class="language-ts"><span class="hl-9">/**</span><br/><span class="hl-9"> * </span><span class="hl-5">@summary</span><br/><span class="hl-9"> * Create an instance of Dropped Asset class with a given dropped asset id, url slug, and optional attributes and session credentials.</span><br/><span class="hl-9"> *</span><br/><span class="hl-9"> * </span><span class="hl-5">@usage</span><br/><span class="hl-9"> * ```ts</span><br/><span class="hl-9"> * await new DroppedAsset(topia, &quot;1giFZb0sQ3X27L7uGyQX&quot;, &quot;example&quot;, { attributes: { text: &quot;&quot; }, credentials: { assetId: &quot;1giFZb0sQ3X27L7uGyQX&quot; } } });</span><br/><span class="hl-9"> * ```</span><br/><span class="hl-9"> */</span>
</code></pre>
<p>Example of method comments</p>
<pre><code class="language-ts"><span class="hl-9">/**</span><br/><span class="hl-9"> * </span><span class="hl-5">@summary</span><br/><span class="hl-9"> * Sets the data object for a dropped asset.</span><br/><span class="hl-9"> *</span><br/><span class="hl-9"> * Optionally, a lock can be provided with this request to ensure only one update happens at a time between all updates that share the same lock id</span><br/><span class="hl-9"> *</span><br/><span class="hl-9"> * </span><span class="hl-5">@usage</span><br/><span class="hl-9"> * ```ts</span><br/><span class="hl-9"> * await droppedAsset.setDroppedAssetDataObject({</span><br/><span class="hl-9"> *   &quot;exampleKey&quot;: &quot;exampleValue&quot;,</span><br/><span class="hl-9"> * });</span><br/><span class="hl-9"> * const { dataObject } = droppedAsset;</span><br/><span class="hl-9"> * ```</span><br/><span class="hl-9"> */</span>
</code></pre>
<br>


<a href="#testing" id="testing" style="color: inherit; text-decoration: none;">
  <h2>Testing</h2>
</a>
<p>We use Jest for testing and take advantage of dependency injection to pass mock data into our services.</p>
<p>To run the test suite, please run <code>yarn test</code>.</p>
<p><br><br></p>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current selected"><a href="modules.html">RTSDK</a>
<ul>
<li class="tsd-kind-module"><a href="modules/controllers.html">controllers</a></li>
<li class="tsd-kind-module"><a href="modules/factories.html">factories</a></li>
<li class="tsd-kind-module"><a href="modules/interfaces.html">interfaces</a></li>
<li class="tsd-kind-module"><a href="modules/types.html">types</a></li>
<li class="tsd-kind-module"><a href="modules/utils.html">utils</a></li></ul></li></ul></div></details></nav></div></div>
<div class="overlay"></div><script src="assets/main.js"></script></body></html>